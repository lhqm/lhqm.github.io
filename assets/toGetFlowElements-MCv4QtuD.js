import{_ as E}from"./ValaxyMain.vue_vue_type_style_index_0_lang-J-klaX4f.js";import{a as d,p as k,o as g,c as o,w as l,f as c,r as t,g as s,h as i}from"./app-bSrHFPqN.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-DnhrUQyh.js";import"./YunCard.vue_vue_type_script_setup_true_lang-CPynrbxK.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-Bs409l9f.js";import"./index-C7yU5XnD.js";const y="/assets/1709796349242-BFb-0p9A.png",F="/assets/1709796461828-MHpn834_.png",D=s("h2",{id:"前言",tabindex:"-1"},[i("前言 "),s("a",{class:"header-anchor",href:"#前言","aria-label":'Permalink to "前言"'},"​")],-1),A=s("p",null,[i("我在"),s("a",{href:"/posts/workflow/toQueryTask"},"Activiti 7获取用户审核任务节点"),i(" 这篇文章中已经讲到过如何获取流程ID和流程实例ID，并提到了"),s("code",null,"流程ID"),i("、"),s("code",null,"流程实例ID"),i("、"),s("code",null,"流程定义ID"),i("的区别。")],-1),u=s("p",null,"为什么要获取流程所有节点以及节点流转的详细信息呢？这是一个浩大的工程。但是最终目的只有一个：",-1),m=s("blockquote",null,[s("p",null,"向面向多租户的流程中台靠近")],-1),_=s("p",null,[i("此时再想想这篇文章撰写的意义，根本就在于"),s("code",null,"通过流程定义信息去获取状态定义信息"),i("，然后我们根据流程节点的抽象信息 ，去构造具体的状态转移过程，然后达成"),s("code",null,"以流程中台流程节点转换，驱动租户端状态机变换"),i("，最终达成租户系统内状态机变迁 由流程中台控制的过程。")],-1),C=s("h2",{id:"准备",tabindex:"-1"},[i("准备 "),s("a",{class:"header-anchor",href:"#准备","aria-label":'Permalink to "准备"'},"​")],-1),v=s("blockquote",null,[s("p",null,"在正式开始写代码之前，我们需要搞清楚目标。")],-1),b=s("p",null,"我在看了activiti 7这一块的源码之后，梳理出来这样一套思路：",-1),w=s("h3",{id:"思路整理",tabindex:"-1"},[i("思路整理 "),s("a",{class:"header-anchor",href:"#思路整理","aria-label":'Permalink to "思路整理"'},"​")],-1),f=s("p",null,"如何由一个流程定义ID甚至流程实例ID，最终得到流程的所有节点信息呢？",-1),B=s("ol",null,[s("li",null,"先得到流程定义ID，这个在上一篇文章中已经提到过了。"),s("li",null,[i("通过流程运行时的"),s("code",null,"repositoryService"),i("获取到流程定义ID下的流程Bpmn实例。")]),s("li",null,"获取到该Bpmn实例下的一个流程对象（一般来说只有一个）。"),s("li",null,"获取到该流程对象的所有流程元素。"),s("li",null,"处理好流程元素，然后发送给租户端，这样在状态迁移时，租户端可以准确知道自己在BPMN图里运行到了哪个步骤。")],-1),x=s("h3",{id:"进一步思考",tabindex:"-1"},[i("进一步思考 "),s("a",{class:"header-anchor",href:"#进一步思考","aria-label":'Permalink to "进一步思考"'},"​")],-1),P=s("p",null,"有了这个思路以后，就可以着手开始规划代码设计了。 但是现在有一个更重要的问题： 流程对象的所有流程元素获取以后，是一个FlowElement集合，类似这样：",-1),S=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//返回数据，这里开始对流程信息进行解构，获取到所有用户任务。因为用户任务才能参与审核，审核才会唤醒流转，流转才会改变状态")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Collection<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FlowElement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> flowElements "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," process."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowElements"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")])])]),s("button",{class:"collapse"})],-1),j=s("p",null,[i("进一步查看源码，发现了一件更恐怖的事情，FlowElement，有"),s("code",null,"42个子类"),i("！")],-1),N=s("p",null,"聪明的你一定会想到，该设计模式出马啦！ 那么去使用什么策略模式呢？策略模式？组合策略模式？还是责任链模式？",-1),I=s("p",null,"除了这个问题以外，还有个更急迫的问题，如何定义一个统一的对象来表示流程要素呢？",-1),M=s("h2",{id:"设计",tabindex:"-1"},[i("设计 "),s("a",{class:"header-anchor",href:"#设计","aria-label":'Permalink to "设计"'},"​")],-1),$=s("p",null,"带着如上问题，开始设计代码，并着手解决存在的问题。",-1),L=s("h3",{id:"定义统一对象",tabindex:"-1"},[i("定义统一对象 "),s("a",{class:"header-anchor",href:"#定义统一对象","aria-label":'Permalink to "定义统一对象"'},"​")],-1),q=s("p",null,"还是如刚开始所说，我们的目的只是让租户端知道整个流程的运行进度，那么只需要告诉租户端这样几大要素即可：",-1),T=s("ul",null,[s("li",null,"元素结点ID"),s("li",null,"前驱结点ID"),s("li",null,"后置结点ID"),s("li",null,"结点名称"),s("li",null,"结点类型"),s("li",null,"子结点集合")],-1),U=s("p",null,[i("这样我们就可以构建一张完整的流程图出来。 由此我们可以得到这个流程返回对象的代码： "),s("code",null,"FlowProcess.java")],-1),O=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Data")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"AllArgsConstructor")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"@"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"NoArgsConstructor")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowProcess"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 当前流程元素ID")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String flowId;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 前一个流程元素ID")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String prev;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 后一个流程元素ID")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String next;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 流程元素名称")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String flowName;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 流程元素类型")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String flowType;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 流程节点所指向的子流程（需要注意，有这个标记的，一定是子流程的外围表达框图）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Collection<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FlowProcess"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> subProcess;")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1),H=s("h3",{id:"顶层设计",tabindex:"-1"},[i("顶层设计 "),s("a",{class:"header-anchor",href:"#顶层设计","aria-label":'Permalink to "顶层设计"'},"​")],-1),z=s("p",null,[i("所以我们的期望是，通过一个流程定义ID，最终"),s("code",null,"获取到统一节点对象集合返回"),i("。因此这个方法可以大致这样写：")],-1),R=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 获取到对应流程定义ID的整体流程信息")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," definitionId"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 流程定义信息ID")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 流程定义信息")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"FlowProcess"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getFlowElementsByProcessDefinition"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String definitionId){")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        获取到流程的模型实例")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        BpmnModel bpmnModel "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," repositoryService."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBpmnModel"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(definitionId);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        在模型的流程表里选择第一个流程作为流程对象定义（一般也只有一个）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Process process "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," bpmnModel."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getProcesses"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        这里开始对流程信息进行解构，获取到所有任务。其中用户任务才能参与审核，审核才会唤醒流转，流转才会改变状态")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        而路径元素更多的是指示两个非路径元素的连接方式")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Collection<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FlowElement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> flowElements "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," process."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowElements"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        获取到流程路径定义")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FlowElementUtil."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowDefinitionMap"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElements);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),s("button",{class:"collapse"})],-1),Z=s("h3",{id:"简化",tabindex:"-1"},[i("简化 "),s("a",{class:"header-anchor",href:"#简化","aria-label":'Permalink to "简化"'},"​")],-1),G=s("h4",{id:"类型抽象",tabindex:"-1"},[i("类型抽象 "),s("a",{class:"header-anchor",href:"#类型抽象","aria-label":'Permalink to "类型抽象"'},"​")],-1),V=s("p",null,"这里可以自己在process这一行打个断点看看，一个流程的定义是如何被存储和表示的，才好写代码。我在这里给一个示例的流程。这个流程应该算是单个流程里边比较复杂的了。",-1),J=s("figure",null,[s("img",{src:y,alt:"1709796349242",loading:"lazy",decoding:"async",class:"lazy"})],-1),Q=s("p",null,"这个流程实际的效果图如下：",-1),K=s("figure",null,[s("img",{src:F,alt:"1709796461828",loading:"lazy",decoding:"async",class:"lazy"})],-1),W=s("p",null,[i("可以看到，这些基本上就是要用的元素了，其中包括："),s("code",null,"开始事件"),i("、"),s("code",null,"结束事件"),i("、"),s("code",null,"用户任务"),i("、"),s("code",null,"网关"),i("、"),s("code",null,"子流程"),i("、"),s("code",null,"流转路径")],-1),X=s("p",null,"所以说我们基本上只需要对这些内容进行整理即可。",-1),Y=s("h4",{id:"设计简化",tabindex:"-1"},[i("设计简化 "),s("a",{class:"header-anchor",href:"#设计简化","aria-label":'Permalink to "设计简化"'},"​")],-1),ss=s("p",null,[i("这里主要是有一个上文未提及的好消息，那就是"),s("code",null,"FlowElement是一个抽象类"),i("：")],-1),is=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," abstract"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowElement"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," extends"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," BaseElement"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HasExecutionListeners"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    protected"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String name;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    protected"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String documentation;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    protected"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ActivitiListener"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> executionListeners "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ArrayList"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    protected"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FlowElementsContainer parentContainer;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1),ls=s("p",null,"而其父级BaseEvent有：",-1),as=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," abstract"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," BaseElement"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HasExtensionAttributes"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    protected"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String id;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    protected"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," xmlRowNumber;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    protected"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," int"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," xmlColumnNumber;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1),ts=s("p",null,"再结合我们的FlowProcess一看，必要元素好像只差前驱后置结点和子流程了。",-1),hs=s("p",null,"但是前驱后置节点只有路径元素有，子流程只有子流程元素有。",-1),es=s("p",null,[i("那么代码就好写多了，我们只需要把"),s("code",null,"路径流转元素"),i("和"),s("code",null,"子流程元素"),i("全部挑出来就行了。")],-1),ns=s("h3",{id:"设计模式",tabindex:"-1"},[i("设计模式 "),s("a",{class:"header-anchor",href:"#设计模式","aria-label":'Permalink to "设计模式"'},"​")],-1),ks=s("p",null,"那么在上述问题一一迎刃而解后，我们需要明确，如何去获取到一个统一的返回对象呢？",-1),ps=s("p",null,"以及有这么两种类型需要判断，我们如何去解决？",-1),rs=s("p",null,[i("很容易想到，使用"),s("code",null,"策略模式"),i("来解决。所以说在统一返回对象的问题上，我们使用策略模式来解决不同类不同字段的问题，这样更方便后期扩展。")],-1),Es=s("h3",{id:"类型表示",tabindex:"-1"},[i("类型表示 "),s("a",{class:"header-anchor",href:"#类型表示","aria-label":'Permalink to "类型表示"'},"​")],-1),ds=s("p",null,[i("我们注意到，还有一个流程类型的字段不知道怎么用。那肯定是用来存"),s("code",null,"流程的class类型"),i("的啦。")],-1),gs=s("p",null,[i("这样，租户端就知道这是个什么节点了。获取class名称很简单，只需要"),s("code",null,"obj.getClass().getName()"),i("就可以获取到，但是这样获取到的是一个全限定名称，而我们只需要一个简单的类名即可，所以可以写一个简单的方法来获取：")],-1),os=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /***")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 通过全限定类名称获取类的直接名称")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," fullClassName"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 全限定名称")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 类名")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," String "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClassNameByFullClassName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(String fullClassName){")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //通过ASCII码来切割点号。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," index "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fullClassName."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"lastIndexOf"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"46"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        如果没命中直接返回，否则返回全限定名称转换后的名称")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," index"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"==-"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fullClassName"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fullClassName."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"substring"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(index"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),s("button",{class:"collapse"})],-1),cs=s("h2",{id:"编码",tabindex:"-1"},[i("编码 "),s("a",{class:"header-anchor",href:"#编码","aria-label":'Permalink to "编码"'},"​")],-1),ys=s("blockquote",null,[s("p",null,"在了解上述需求和问题的解决方案后，我们就可以开始着手去解决问题了")],-1),Fs=s("p",null,"那么切入点就是：",-1),Ds=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"List<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FlowProcess"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> flowDefinitionMap"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"FlowElementUtil."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowDefinitionMap"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElements);")])])]),s("button",{class:"collapse"})],-1),As=s("h3",{id:"获取流程信息",tabindex:"-1"},[i("获取流程信息 "),s("a",{class:"header-anchor",href:"#获取流程信息","aria-label":'Permalink to "获取流程信息"'},"​")],-1),us=s("p",null,"有了这个flowElement集合，我们首先需要传入一个单独的方法进行处理，而不是在原本的方法里循环处理，至于为什么，等到了解子流程的组织之后你就懂了：",-1),ms=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 获取流程定义图（注意，是图，存在多级的巡向和父子关系，一个节点可能有好几个父子关系）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 可能存在：")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 1.顺序流程")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 2.排他网关并线")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 3.子流程")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 4.嵌套子流程")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 5.自子流程内连续越级进入主流程的现象")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@param"),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}}," flowElements"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 流程顶层节点")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@return"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 流程数据")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," List"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"FlowProcess"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getFlowDefinitionMap"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(Collection"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"FlowElement"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," flowElements){")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        List<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FlowProcess"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> processes"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=new"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," LinkedList<>();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        循环element,找到流程定义")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (FlowElement element "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," flowElements) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            processes."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"add"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowProcessByFlowElement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(element));")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," processes;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),s("button",{class:"collapse"})],-1),_s=s("p",null,"很明显，我们把一个流程，先抽象成了多个流程节点的集合，然后在流程节点里进行循环，逐个击破。",-1),Cs=s("p",null,"所以还需要另外一个处理单个流程元素的方法，来对单个元素进行处理：",-1),vs=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FlowProcess "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowProcessByFlowElement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(FlowElement flowElement){")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        获取统一的返回对象的代码")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//		  ...")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //返回结果")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ...;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),s("button",{class:"collapse"})],-1),bs=s("h3",{id:"执行策略",tabindex:"-1"},[i("执行策略 "),s("a",{class:"header-anchor",href:"#执行策略","aria-label":'Permalink to "执行策略"'},"​")],-1),ws=s("p",null,"此时我们就需要一个策略类了，策略类应该包括：",-1),fs=s("p",null,"1.对注册的策略的处理",-1),Bs=s("p",null,"2.对未注册的策略的统一处理",-1),xs=s("h4",{id:"策略类定义",tabindex:"-1"},[i("策略类定义 "),s("a",{class:"header-anchor",href:"#策略类定义","aria-label":'Permalink to "策略类定义"'},"​")],-1),Ps=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * 策略执行类接口")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," interface"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowElementStrategy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    FlowProcess "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"execute"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(FlowElement "),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"flowElement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1),Ss=s("p",null,"只需要后续的实际处理类都来继承这个策略接口即可。",-1),js=s("h4",{id:"流转节点策略",tabindex:"-1"},[i("流转节点策略 "),s("a",{class:"header-anchor",href:"#流转节点策略","aria-label":'Permalink to "流转节点策略"'},"​")],-1),Ns=s("p",null,"在这里，我们对流转策略进行处理",-1),Is=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * 中间流程路径节点")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SequenceFlowElementStrategy"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowElementStrategy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FlowProcess "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"execute"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(FlowElement "),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"flowElement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SequenceFlow element "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (SequenceFlow) flowElement;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowProcess"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(element."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(), element."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getSourceRef"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(), element."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getTargetRef"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(),")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                element."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(), StringUtils."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClassNameByFullClassName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElement."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClass"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()),"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1),Ms=s("p",null,"只需要转入的时候直接强转类型就行，因为系统已经可以识别到这个属于流转元素类型了。",-1),$s=s("p",null,[i("我们需要做的是，针对流转路径元素，注意"),s("code",null,"拿到它的前驱结点和后置结点"),i("。")],-1),Ls=s("h4",{id:"子流程节点策略",tabindex:"-1"},[i("子流程节点策略 "),s("a",{class:"header-anchor",href:"#子流程节点策略","aria-label":'Permalink to "子流程节点策略"'},"​")],-1),qs=s("p",null,"与流转节点大致相同，不同的是，在子流程节点，我们需要获取子流程的详细定义，这个肯定是需要递归的，那么怎么实现类似递归呢？",-1),Ts=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SubProcessFlowElementStrategy"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," implements"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowElementStrategy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    @"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Override")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FlowProcess "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"execute"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(FlowElement "),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"flowElement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        对于")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        SubProcess element "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (SubProcess) flowElement;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowProcess"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(element."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(),"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                flowElement."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(),")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                StringUtils."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClassNameByFullClassName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElement."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClass"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()),")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                FlowElementUtil."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowDefinitionMap"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(element."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowElements"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()));")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1),Us=s("p",null,[i("没错，再去调"),s("code",null,"FlowElementUtil.getFlowDefinitionMap()"),i("方法即可。这也可以解答前边那个问题了，为什么不在方法里循环，而是单独抽出来，原因就是在这里去实现类似递归的方式，深层递归流程的每一个元素。")],-1),Os=s("h4",{id:"策略执行",tabindex:"-1"},[i("策略执行 "),s("a",{class:"header-anchor",href:"#策略执行","aria-label":'Permalink to "策略执行"'},"​")],-1),Hs=s("p",null,"有了上述流程，我们需要一个执行类，去封装执行所有策略。",-1),zs=s("p",null,"容易预见的是，直接使用类的class对象即可。",-1),Rs=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowElementStrategyExecutor"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Map<Class<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">, "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FlowElementStrategy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> strategies;")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowElementStrategyExecutor"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".strategies "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," HashMap<>();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        //TODO: 注册所有不可忽略的策略")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        流转流程元素（需要处理前后节点的组织关系）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        strategies."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SequenceFlow.class,"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SequenceFlowElementStrategy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        子流程元素（需要处理子流程的构造逻辑）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        strategies."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"put"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(SubProcess.class,"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," SubProcessFlowElementStrategy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FlowProcess "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"executeStrategy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(FlowElement "),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"flowElement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        根据流程类型，选择执行对应的操作去处理元素节点组织关系")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Class<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> flowElementClass "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," flowElement."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClass"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        FlowElementStrategy strategy "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," strategies."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElementClass);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        匹配到策略，执行对应的处理")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (strategy "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," strategy."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"execute"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElement);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1),Zs=s("h4",{id:"无策略处理",tabindex:"-1"},[i("无策略处理 "),s("a",{class:"header-anchor",href:"#无策略处理","aria-label":'Permalink to "无策略处理"'},"​")],-1),Gs=s("p",null,[i("如果没有对应的策略应该怎么办呢？上文已经提到了，FlowElement是个抽象类，它里边的元素已经满足了大部分子类的需求了，那么只需要改写"),s("code",null,"executeStrategy"),i("方法：")],-1),Vs=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FlowProcess "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"executeStrategy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(FlowElement flowElement) {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        根据流程类型，选择执行对应的操作去处理元素节点组织关系")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Class<"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"?"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> flowElementClass "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," flowElement."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClass"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        FlowElementStrategy strategy "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," strategies."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElementClass);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        匹配到策略，执行对应的处理")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (strategy "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," strategy."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"execute"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElement);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        } "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"else"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 如果没有匹配的策略，返回未识别实例类型（也可能是下述操作已经足够满足获取逻辑了）")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            return"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowProcess"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElement."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getId"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(),"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",flowElement."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(), StringUtils."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClassNameByFullClassName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElement."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getClass"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()),"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),s("button",{class:"collapse"})],-1),Js=s("p",null,"加一串没有匹配的方法即可。",-1),Qs=s("h3",{id:"实例化策略",tabindex:"-1"},[i("实例化策略 "),s("a",{class:"header-anchor",href:"#实例化策略","aria-label":'Permalink to "实例化策略"'},"​")],-1),Ks=s("p",null,"在编写好策略以后，就可以实例化使用了：",-1),Ws=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowElementUtil"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," final"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FlowElementStrategyExecutor executor;")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    /**")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     * 工具类加载初始化时，注册策略类")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"     */")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        executor "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," FlowElementStrategyExecutor"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"collapse"})],-1),Xs=s("p",null,"然后在我们还没写完的这个private方法里去调用：",-1),Ys=s("div",{style:{"max-height":"400px"},class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    private"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," FlowProcess "),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowProcessByFlowElement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(FlowElement flowElement){")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        获取流程")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        FlowProcess flowProcess "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," executor."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"executeStrategy"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(flowElement);")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//        为没有名字的节点加上默认名字")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (flowProcess."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getFlowName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"null"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") flowProcess."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setFlowName"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"未命名流程节点"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," flowProcess;")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")])])]),s("button",{class:"collapse"})],-1),si=s("p",null,"大功告成。",-1),ri={__name:"toGetFlowElements",setup(ii,{expose:p}){const h=JSON.parse('{"title":"Activiti 7获取流程定义节点详情","description":"","frontmatter":{"title":"Activiti 7获取流程定义节点详情","date":"2024-03-07T00:00:00.000Z","updated":"2024-03-07T00:00:00.000Z","categories":"工作流","codeHeightLimit":400,"tags":["activiti","java"]},"headers":[{"level":2,"title":"前言","slug":"前言","link":"#前言","children":[]},{"level":2,"title":"准备","slug":"准备","link":"#准备","children":[{"level":3,"title":"思路整理","slug":"思路整理","link":"#思路整理","children":[]},{"level":3,"title":"进一步思考","slug":"进一步思考","link":"#进一步思考","children":[]}]},{"level":2,"title":"设计","slug":"设计","link":"#设计","children":[{"level":3,"title":"定义统一对象","slug":"定义统一对象","link":"#定义统一对象","children":[]},{"level":3,"title":"顶层设计","slug":"顶层设计","link":"#顶层设计","children":[]},{"level":3,"title":"简化","slug":"简化","link":"#简化","children":[]},{"level":3,"title":"设计模式","slug":"设计模式","link":"#设计模式","children":[]},{"level":3,"title":"类型表示","slug":"类型表示","link":"#类型表示","children":[]}]},{"level":2,"title":"编码","slug":"编码","link":"#编码","children":[{"level":3,"title":"获取流程信息","slug":"获取流程信息","link":"#获取流程信息","children":[]},{"level":3,"title":"执行策略","slug":"执行策略","link":"#执行策略","children":[]},{"level":3,"title":"实例化策略","slug":"实例化策略","link":"#实例化策略","children":[]}]}],"relativePath":"pages/posts/workflow/toGetFlowElements.md","path":"/home/runner/work/lhqm.github.io/lhqm.github.io/pages/posts/workflow/toGetFlowElements.md","lastUpdated":1715585358000}'),n=d(),e=h.frontmatter||{};return n.meta.frontmatter=Object.assign(n.meta.frontmatter||{},h.frontmatter||{}),k("pageData",h),k("valaxy:frontmatter",e),globalThis.$frontmatter=e,p({frontmatter:{title:"Activiti 7获取流程定义节点详情",date:"2024-03-07T00:00:00.000Z",updated:"2024-03-07T00:00:00.000Z",categories:"工作流",codeHeightLimit:400,tags:["activiti","java"]}}),(a,ai)=>{const r=E;return g(),o(r,{frontmatter:c(e)},{"main-content-md":l(()=>[D,A,u,m,_,C,v,b,w,f,B,x,P,S,j,N,I,M,$,L,q,T,U,O,H,z,R,Z,G,V,J,Q,K,W,X,Y,ss,is,ls,as,ts,hs,es,ns,ks,ps,rs,Es,ds,gs,os,cs,ys,Fs,Ds,As,us,ms,_s,Cs,vs,bs,ws,fs,Bs,xs,Ps,Ss,js,Ns,Is,Ms,$s,Ls,qs,Ts,Us,Os,Hs,zs,Rs,Zs,Gs,Vs,Js,Qs,Ks,Ws,Xs,Ys,si]),"main-header":l(()=>[t(a.$slots,"main-header")]),"main-header-after":l(()=>[t(a.$slots,"main-header-after")]),"main-nav":l(()=>[t(a.$slots,"main-nav")]),"main-content":l(()=>[t(a.$slots,"main-content")]),"main-content-after":l(()=>[t(a.$slots,"main-content-after")]),"main-nav-before":l(()=>[t(a.$slots,"main-nav-before")]),"main-nav-after":l(()=>[t(a.$slots,"main-nav-after")]),comment:l(()=>[t(a.$slots,"comment")]),footer:l(()=>[t(a.$slots,"footer")]),aside:l(()=>[t(a.$slots,"aside")]),"aside-custom":l(()=>[t(a.$slots,"aside-custom")]),default:l(()=>[t(a.$slots,"default")]),_:3},8,["frontmatter"])}}};export{ri as default};
