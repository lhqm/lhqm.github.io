import{_ as E}from"./ValaxyMain.vue_vue_type_style_index_0_lang-J-klaX4f.js";import{a as d,p as k,o,c,w as a,f as g,r as e,g as s,h as i}from"./app-bSrHFPqN.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-DnhrUQyh.js";import"./YunCard.vue_vue_type_script_setup_true_lang-CPynrbxK.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-Bs409l9f.js";import"./index-C7yU5XnD.js";const y="/assets/1706522219277-B_v2VMsT.png",u="/assets/1706522315947-w4ZjEn9f.png",F=s("h2",{id:"前言",tabindex:"-1"},[i("前言 "),s("a",{class:"header-anchor",href:"#前言","aria-label":'Permalink to "前言"'},"​")],-1),m=s("p",null,[i("在将控件打包为exe可执行程序以后，项目并不能"),s("code",null,"直接在用户机器上安装并启动"),i("。我们的最终目的是让这个Java程序 能够像"),s("code",null,"原生Windows程序"),i("一样被用户"),s("code",null,"安装"),i("、"),s("code",null,"授权"),i("、"),s("code",null,"无感知自启")],-1),A=s("h2",{id:"准备工作",tabindex:"-1"},[i("准备工作 "),s("a",{class:"header-anchor",href:"#准备工作","aria-label":'Permalink to "准备工作"'},"​")],-1),D=s("p",null,[i("你需要准备好来自exe4j打包的程序。如果你尚未拥有这一步的成果，"),s("strong",null,"请看这篇文章"),i("： "),s("a",{href:"/posts/clipPaste/toExe"},"进一步将本地粘贴控件打包为可执行程序")],-1),f=s("p",null,[i("然后你需要下载"),s("code",null,"Inno Setup 6"),i("，记住，是"),s("code",null,"inno setup 6"),i("，"),s("code",null,"inno setup"),i("，版本是"),s("code",null,"6"),i("，不然待会版本和我不一样，可能有其他问题。")],-1),C=s("blockquote",null,[s("p",null,[i("好的，现在我假设你已经下载了inno setup 6。"),s("s",null,"(没下的滚出克！)")])],-1),N=s("h2",{id:"脚本编写",tabindex:"-1"},[i("脚本编写 "),s("a",{class:"header-anchor",href:"#脚本编写","aria-label":'Permalink to "脚本编写"'},"​")],-1),v=s("blockquote",null,[s("p",null,[i("这个编译器可以让你梦回"),s("code",null,"Dev c++"),i("，"),s("s",null,"太美丽了家人们！")])],-1),b=s("h3",{id:"开启软件",tabindex:"-1"},[i("开启软件 "),s("a",{class:"header-anchor",href:"#开启软件","aria-label":'Permalink to "开启软件"'},"​")],-1),M=s("p",null,[s("code",null,"安装路径"),i("下去戳这个 "),s("img",{src:y,alt:"1706522219277"}),i(" 戳开了是这样的，直接选就行了，会让你自己另存为脚本，自己保管好。")],-1),B=s("figure",null,[s("img",{src:u,alt:"1706522315947",loading:"lazy",decoding:"async",class:"lazy"})],-1),_=s("h3",{id:"编写脚本",tabindex:"-1"},[i("编写脚本 "),s("a",{class:"header-anchor",href:"#编写脚本","aria-label":'Permalink to "编写脚本"'},"​")],-1),T=s("blockquote",null,[s("p",null,[i("这一步抄作业就完事了，需要自定义的地方自行自定义就完事了。"),s("code",null,"（已高亮指出）")]),s("p",null,[s("code",null,"标红的地方"),i("是下一节"),s("code",null,"可信签名"),i("的或者其他可有可无的代码，如果"),s("code",null,"不需要运行安全签名"),i("可以先注释掉")])],-1),R=s("div",{style:{"max-height":"300px"},class:"language-pascal vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"pascal"),s("pre",{class:"shiki shiki-themes github-light github-dark has-diff vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; Script generated "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"by"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," the Inno Setup Script Wizard.")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; SEE THE DOCUMENTATION "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FOR"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," DETAILS "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ON"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," CREATING INNO SETUP SCRIPT FILES!")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'#define MyAppName "ruifox clip '),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"helper"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'" ')]),i(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'#define MyAppVersion "'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1.6"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'" ')]),i(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'#define MyAppPublisher "小狐狸科技" ')]),i(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'#define MyAppURL "http:'),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},'//www.xiaohuli.com/"')]),i(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'#define MyAppExeName "cliphelper.exe" ')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Setup]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; NOTE: The value "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"of"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," AppId uniquely identifies this application. "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Do"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," not"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," use the same AppId value "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," installers "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," other applications.")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; ("),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"To"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," generate a "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"new"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," GUID, click Tools | Generate GUID inside the IDE.)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AppId="),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{{8730F218-3243-4552-9648-C5F9D85334C1}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AppName="),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{#MyAppName}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AppVersion="),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{#MyAppVersion}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";AppVerName="),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{#MyAppName}"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," {#MyAppVersion}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AppPublisher="),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{#MyAppPublisher}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AppPublisherURL="),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{#MyAppURL}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AppSupportURL="),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{#MyAppURL}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AppUpdatesURL="),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{#MyAppURL}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DefaultDirName="),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{autopf}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"\\"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{#MyAppName}")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DisableProgramGroupPage=yes")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'; The [Icons] "quicklaunchicon" entry '),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"uses"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," {userappdata}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," but its [Tasks] entry "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"has"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," a proper IsAdminInstallMode Check.")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"UsedUserAreasWarning=yes")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; Uncomment the following line "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"to"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," run "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," non administrative install mode (install "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," current user "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"only"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".)")]),i(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";PrivilegesRequired=lowest ")]),i(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"OutputBaseFilename=ruifox-clip-"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"helper")]),i(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"SetupIconFile=D:\\学习文档\\图片资源\\favicon.ico ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Compression=lzma")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"SolidCompression=yes")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"WizardStyle=modern")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";设置不显示提示框")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DisableStartupPrompt=yes")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";禁止安装完成显示安装界面")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DisableFinishedPage=no")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";索要管理员权限")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PrivilegesRequired=lowest")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";是否打开->可选安装开始菜单项")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"AllowNoIcons=yes")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";指定RSA算法进行代码签名")]),i(`
`),s("span",{class:"line diff remove"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"SignTool=sha1 ")]),i(`
`),s("span",{class:"line diff remove"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";SignTool=sha256 ")]),i(`
`),s("span",{class:"line diff remove"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"SignedUninstaller=yes ")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Languages]")]),i(`
`),s("span",{class:"line diff add"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Name"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},': "english"; MessagesFile: "compiler:'),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Default"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'.isl" ')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Tasks]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Name"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},': "desktopicon"; Description: "'),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{cm:CreateDesktopIcon}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'"; GroupDescription: "'),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{cm:AdditionalIcons}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'"; '),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Flags"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": unchecked")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Name"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},': "quicklaunchicon"; Description: "'),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{cm:CreateQuickLaunchIcon}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'"; GroupDescription: "'),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{cm:AdditionalIcons}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'"; '),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Flags"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": unchecked; OnlyBelowVersion: "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"6.1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; Check: "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"not"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," IsAdminInstallMode")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";开机自启动的标签，注册到用户的home目录。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Name"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},': "startupicon"; Description: "'),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{cm:CreateQuickLaunchIcon}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'"; GroupDescription: "'),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{cm:AdditionalIcons}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'";')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Files]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";对启动文件进行电子签名")]),i(`
`),s("span",{class:"line diff remove"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'Source: "D:\\exe4j\\exeDir\\cliphelper.exe"; DestDir: "'),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{app}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'"; '),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Flags"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ignoreversion signonce ")]),i(`
`),s("span",{class:"line diff remove"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'Source: "D:\\exe4j\\exeDir\\*"; DestDir: "'),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"{app}"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},'"; '),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"Flags"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": ignoreversion recursesubdirs createallsubdirs ")]),i(`
`),s("span",{class:"line diff remove"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; NOTE: Don"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`'t use "Flags: ignoreversion" on any shared system files`)]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"[Icons]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'Name: "{autoprograms}\\{#MyAppName}"; Filename: "{app}\\{#MyAppExeName}"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'Name: "{autodesktop}\\{#MyAppName}"; Filename: "{app}\\{#MyAppExeName}"; Tasks: desktopicon')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'Name: "{userappdata}\\Microsoft\\Internet Explorer\\Quick Launch\\{#MyAppName}"; Filename: "{app}\\{#MyAppExeName}"; Tasks: quicklaunchicon')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},";设置开机启动")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'Name: "{userstartup}\\{#MyAppName}"; Filename: "{app}\\{#MyAppExeName}"; Tasks:desktopicon')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"[Dirs]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Name: {app}; Permissions: users-full")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"[Run]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`Filename: "{app}\\{#MyAppExeName}"; Description: "{cm:LaunchProgram,{#StringChange(MyAppName, '`),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"', '"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&&"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`')}}"; Flags: nowait postinstall skipifsilent`)]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'Filename: "{sys}\\cmd.exe"; Parameters: "/C echo {app}\\{#MyAppExeName} >> %appdata%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\ruifoxClip.bat"; Flags: runhidden')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},";写注册表")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},";[Registry]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},';Root: "HKCU"; Subkey: "Software\\Microsoft\\Windows\\CurrentVersion\\Run"; ValueType: string; ValueName: "{#MyAppName}"; ValueData: "{app}\\{#MyAppExeName}"; Flags: uninsdeletevalue')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"[Registry]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Root:HKCR;Subkey:FOXC;ValueType:string;ValueName:;ValueData:URL:Invoked Protocol Handler;Flags:uninsdeletevalue")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Root:HKCR;Subkey:FOXC;ValueType:string;ValueName:URL Protocol;ValueData:;Flags:uninsdeletevalue")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Root:HKCR;Subkey:FOXC\\DefaultIcon;ValueType:string;ValueName:;ValueData:{app}\\{#MyAppExeName};Flags:uninsdeletevalue")]),i(`
`),s("span",{class:"line diff remove"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Root:HKCR;Subkey:FOXC\\shell;ValueType:string;ValueName:;ValueData:;Flags:uninsdeletevalue")]),i(`
`),s("span",{class:"line diff remove"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Root:HKCR;Subkey:FOXC\\shell\\open;ValueType:string;ValueName:;ValueData:;Flags:uninsdeletevalue")]),i(`
`),s("span",{class:"line diff remove"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`Root:HKCR;Subkey:FOXC\\shell\\open\\command;ValueType:string;ValueName:;ValueData:"{app}\\{#MyAppExeName} '`),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"%"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},`'";Flags:uninsdeletevalue`)]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"[InstallDelete]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},";卸载的时候删掉整个目录")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'Type: filesandordirs; Name: "{app}"')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"[UninstallRun]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},";卸载时停掉程序以使得程序可以被安全删除")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'Filename: "cmd.exe"; Parameters: "/C taskkill /IM {#MyAppExeName} /F"; Flags: runhidden')])])]),s("button",{class:"collapse"})],-1),S=s("h3",{id:"运行脚本",tabindex:"-1"},[i("运行脚本 "),s("a",{class:"header-anchor",href:"#运行脚本","aria-label":'Permalink to "运行脚本"'},"​")],-1),I=s("p",null,[i("软件"),s("code",null,"左上角"),i("那个和"),s("code",null,"VC 6.0"),i("的运行按钮长得一模一样的就是，点一下就开始运行了。")],-1),H={__name:"setup",setup(V,{expose:p}){const n=JSON.parse('{"title":"本地化粘贴控件进一步打包为可安装程序","description":"","frontmatter":{"title":"本地化粘贴控件进一步打包为可安装程序","date":"2024-01-12T00:00:00.000Z","updated":"2024-01-29T00:00:00.000Z","categories":"小项目","codeHeightLimit":300,"tags":["开源","Java","粘贴控件"]},"headers":[{"level":2,"title":"前言","slug":"前言","link":"#前言","children":[]},{"level":2,"title":"准备工作","slug":"准备工作","link":"#准备工作","children":[]},{"level":2,"title":"脚本编写","slug":"脚本编写","link":"#脚本编写","children":[{"level":3,"title":"开启软件","slug":"开启软件","link":"#开启软件","children":[]},{"level":3,"title":"编写脚本","slug":"编写脚本","link":"#编写脚本","children":[]},{"level":3,"title":"运行脚本","slug":"运行脚本","link":"#运行脚本","children":[]}]}],"relativePath":"pages/posts/clipPaste/setup.md","path":"/home/runner/work/lhqm.github.io/lhqm.github.io/pages/posts/clipPaste/setup.md","lastUpdated":1715585358000}'),h=d(),t=n.frontmatter||{};return h.meta.frontmatter=Object.assign(h.meta.frontmatter||{},n.frontmatter||{}),k("pageData",n),k("valaxy:frontmatter",t),globalThis.$frontmatter=t,p({frontmatter:{title:"本地化粘贴控件进一步打包为可安装程序",date:"2024-01-12T00:00:00.000Z",updated:"2024-01-29T00:00:00.000Z",categories:"小项目",codeHeightLimit:300,tags:["开源","Java","粘贴控件"]}}),(l,P)=>{const r=E;return o(),c(r,{frontmatter:g(t)},{"main-content-md":a(()=>[F,m,A,D,f,C,N,v,b,M,B,_,T,R,S,I]),"main-header":a(()=>[e(l.$slots,"main-header")]),"main-header-after":a(()=>[e(l.$slots,"main-header-after")]),"main-nav":a(()=>[e(l.$slots,"main-nav")]),"main-content":a(()=>[e(l.$slots,"main-content")]),"main-content-after":a(()=>[e(l.$slots,"main-content-after")]),"main-nav-before":a(()=>[e(l.$slots,"main-nav-before")]),"main-nav-after":a(()=>[e(l.$slots,"main-nav-after")]),comment:a(()=>[e(l.$slots,"comment")]),footer:a(()=>[e(l.$slots,"footer")]),aside:a(()=>[e(l.$slots,"aside")]),"aside-custom":a(()=>[e(l.$slots,"aside-custom")]),default:a(()=>[e(l.$slots,"default")]),_:3},8,["frontmatter"])}}};export{H as default};
